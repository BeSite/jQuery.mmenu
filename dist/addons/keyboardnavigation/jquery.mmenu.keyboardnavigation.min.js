/*
 * jQuery mmenu keyboardNavigation addon
 * mmenu.frebsite.nl
 *
 * Copyright (c) Fred Heusschen
 */
!function(n){function t(t,e){t||(t=this.$pnls.children("."+s.current));var a=n();"default"==e&&(a=t.children("."+s.listview).find("a[href]").not(":hidden"),a.length||(a=t.find(r).not(":hidden")),a.length||(a=this.$menu.children("."+s.navbar).find(r).not(":hidden"))),a.length||(a=this.$menu.children("."+s.tabstart)),a.first().focus()}function e(n){n||(n=this.$pnls.children("."+s.current));var t=this.$pnls.children("."+s.panel),e=t.not(n);e.find(r).attr("tabindex",-1),n.find(r).attr("tabindex",0),n.find("input.mm-toggle, input.mm-check, a[href]."+s.title).attr("tabindex",-1)}var a="mmenu",i="keyboardNavigation";n[a].addons[i]={setup:function(){var o=this,c=this.opts[i];this.conf[i];d=n[a].glbl,"boolean"!=typeof c&&"string"!=typeof c||(c={enable:c}),"object"!=typeof c&&(c={}),c=this.opts[i]=n.extend(!0,{},n[a].defaults[i],c),c.trigger&&n(c.trigger).addClass(s.trigger),c.enable&&(c.enhance&&this.$menu.addClass(s.keyboardfocus),this.bind("initPanels",function(){this.$menu.find(r).first().addClass(s.tabstart),n("."+s.panels+" > ."+s.panel).each(function(){n(this).find(r).last().addClass(s.tabend)})}),this.bind("open",function(){e.call(this),this.__transitionend(this.$menu,function(){t.call(o,null,c.enable)},this.conf.transitionDuration)}),this.bind("openPanel",function(n){e.call(this,n),this.__transitionend(n,function(){t.call(o,n,c.enable)},this.conf.transitionDuration)}),this["_initWindow_"+i](c.enhance))},add:function(){s=n[a]._c,o=n[a]._d,c=n[a]._e,s.add("tabstart tabend keyboardfocus trigger"),c.add("keydown focusout")},clickAnchor:function(n,t){}},n[a].defaults[i]={enable:!1,enhance:!1},n[a].configuration[i]={},n[a].prototype["_initWindow_"+i]=function(t){d.$wndw.off(c.keydown+"-offCanvas"),d.$wndw.off(c.focusout+"-"+i).on(c.focusout+"-"+i,function(t){var e=n(t.target);d.$html.hasClass(s.opened)&&e.is("."+s.trigger)&&n("."+s.tabstart).focus()}),d.$wndw.off(c.keydown+"-"+i).on(c.keydown+"-"+i,function(t){var e=n(t.target),a=e.closest("."+s.menu);if(a.length){a.data("mmenu");if(e.is("input, textarea"));else switch(t.keyCode){case 13:(e.is(".mm-toggle")||e.is(".mm-check"))&&e.trigger(c.click);break;case 9:e.is("."+s.tabend)&&!t.shiftKey&&(t.preventDefault(),n("."+s.trigger).focus());break;case 32:case 37:case 38:case 39:case 40:t.preventDefault()}}}),t&&d.$wndw.on(c.keydown+"-"+i,function(t){var e=n(t.target),a=e.closest("."+s.menu);if(a.length){var i=a.data("mmenu");if(e.is("input, textarea"))switch(t.keyCode){case 27:e.val("")}else switch(t.keyCode){case 8:var c=e.closest("."+s.panel).data(o.parent);c&&c.length&&i.openPanel(c.closest("."+s.panel));break;case 27:a.hasClass(s.offcanvas)&&i.close()}}})};var s,o,c,d,r="input, select, textarea, button, label, a[href]"}(jQuery);